<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DBcolor - Análise Double</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>
          DBcolor - Análise Double
          <span
            id="headerSquare"
            class="header-square"
            title="Estado do quadrado"></span>
        </h1>
        <div class="header-right">
          <div class="user-info" id="userInfo" style="display: none">
            <div class="user-details">
              <span id="userEmail"></span>
            </div>
            <div class="user-actions">
              <button id="btnLogout" class="logout-btn">Logout</button>
            </div>
          </div>
          <div class="status-indicator">
            <span class="status-dot" id="statusDot"></span>
            <span id="statusText">Conectando...</span>
          </div>
        </div>
      </header>

      <!-- Estatísticas -->
      <section class="stats-section">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">
              Total
              <span style="font-size: 0.85em; color: var(--text-secondary)"
                >(50 mais recentes)</span
              >
            </div>
            <div class="stat-value" id="statTotal">0</div>
          </div>
          <div class="stat-card win">
            <div class="stat-label">Wins</div>
            <div class="stat-value" id="statWins">0</div>
            <div
              class="stat-value"
              id="statWinsPct"
              style="font-size: 0.9em; color: var(--text-secondary)">
              0%
            </div>
          </div>
          <div class="stat-card loss">
            <div class="stat-label">Loss</div>
            <div class="stat-value" id="statLosses">0</div>
          </div>
          <div class="stat-card red">
            <div class="stat-label">Vermelho</div>
            <div class="stat-value" id="statRed">0</div>
          </div>
          <div class="stat-card black">
            <div class="stat-label">Preto</div>
            <div class="stat-value" id="statBlack">0</div>
          </div>
          <div class="stat-card white">
            <div class="stat-label">Branco</div>
            <div class="stat-value" id="statWhite">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Sequência Atual</div>
            <div class="stat-value" id="statStreak">-</div>
          </div>
        </div>
      </section>

      <!-- Game iframe (embed) -->
      <section class="game-section">
        <div class="game-container">
          <!-- Some casinos block embedding via X-Frame-Options; add a fallback link below -->
          <div class="game-controls">
            <button id="reloadGameBtn" class="reload-btn">
              Recarregar jogo
            </button>
          </div>
          <iframe
            id="playnaIframe"
            src="https://playnabets.com/casino/soline/mobi_Dobrar"
            title="Playna Bets - Soline"
            loading="lazy"
            referrerpolicy="no-referrer"
            allowfullscreen></iframe>
        </div>
        <div
          style="
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
          ">
          Se o jogo não carregar, abra em nova guia:
          <a
            href="https://playnabets.com/casino/soline/mobi_Dobrar"
            target="_blank"
            rel="noopener noreferrer"
            >Abrir Playna Bets</a
          >
        </div>
      </section>

      <!-- Sinal Atual -->
      <section class="signal-section" id="signalSection" style="display: block">
        <div class="signal-card" id="signalCard" tabindex="-1">
          <div class="signal-header">
            <span class="signal-badge" id="signalBadge">SINAL</span>
            <span class="signal-confidence" id="signalConfidence"></span>
          </div>
          <div
            class="signal-pending"
            id="signalPendingStatus"
            style="
              display: none;
              margin-top: 6px;
              font-weight: 600;
              color: #ff9800;
            ">
            Aguardando resolução...
          </div>
          <div class="signal-description" id="signalDescription">
            Analisando padrões, aguarde!
          </div>
          <div class="signal-details">
            <div class="signal-info">
              <strong>Aposta Sugerida:</strong>
              <div class="signal-bet-group">
                <span id="signalBet"></span>
                <span
                  id="signalColorSquare"
                  class="color-square"
                  style="display: none"></span>
              </div>
            </div>
            <div class="signal-info">
              <strong>Números:</strong>
              <span id="signalNumbers"></span>
            </div>
            <div class="signal-info">
              <strong>Probabilidade:</strong>
              <span id="signalProbability"></span>
            </div>
          </div>
          <!-- Ação sugerida removida: agora as sugestões numéricas não são exibidas -->
          <div class="signal-reasons" id="signalReasons"></div>
        </div>
      </section>

      <!-- Resultados Recentes -->
      <section class="results-section">
        <h2>Resultados Recentes</h2>
        <div class="results-scroll-container">
          <div class="results-grid" id="resultsGrid">
            <!-- Resultados serão inseridos aqui via JavaScript -->
          </div>
        </div>
      </section>

      <!-- Último acerto / último loss -->
      <section class="last-signal-times-section">
        <h2>Último Resultado de Sinal</h2>
        <div class="times-grid">
          <div class="time-card">
            <div class="time-label">Último Acerto</div>
            <div class="time-value" id="lastWinTime">-</div>
          </div>
          <div class="time-card">
            <div class="time-label">Último Loss</div>
            <div class="time-value" id="lastLossTime">-</div>
          </div>
        </div>
      </section>

      <!-- Profit simulator removed -->

      <!-- Debug controls (removed) -->

      <!-- Histórico de Sinais removido para simplificar a interface -->
      <audio
        id="signalAlertSound"
        src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"
        preload="auto"></audio>
    </div>

    <!-- Modal de Configurações -->
    <div id="settingsModal" class="modal" style="display: none">
      <div class="modal-content">
        <span class="close" id="closeSettings">&times;</span>
        <h2>Configurações de Alertas</h2>
        <form id="settingsForm">
          <div class="form-group">
            <label>
              <input type="checkbox" id="receiveAlerts" checked />
              Receber alertas
            </label>
          </div>
          <div class="form-group">
            <label>Cores habilitadas:</label>
            <div class="checkbox-group">
              <label
                ><input type="checkbox" id="colorRed" value="red" checked />
                Vermelho</label
              >
              <label
                ><input type="checkbox" id="colorBlack" value="black" checked />
                Preto</label
              >
              <label
                ><input type="checkbox" id="colorWhite" value="white" checked />
                Branco</label
              >
            </div>
          </div>
          <div class="form-group">
            <label for="enabledPatterns"
              >Padrões habilitados (separados por vírgula, vazio =
              todos):</label
            >
            <input
              type="text"
              id="enabledPatterns"
              placeholder="ex: color_streak, alternation" />
          </div>
          <button type="submit" class="btn-primary">Salvar</button>
        </form>
      </div>
    </div>

    <script src="app.js?v=2"></script>
    <div id="betSignupModal" class="modal" style="display: none">
      <div class="modal-content">
        <span class="close" id="closeBetSignup">&times;</span>
        <h2 class="modal-title">Cadastro na Casa de Apostas</h2>
        <p class="modal-description">
          Crie sua conta na Playna Bets para utilizar os sinais com a casa
          suportada.
        </p>
        <a
          href="https://playnabets.com/cadastro?refId=NjMzMTRyZWZJZA=="
          target="_blank"
          rel="noopener noreferrer"
          class="btn-primary"
          style="text-decoration: none"
          >Cadastrar na Playna Bets</a
        >
      </div>
    </div>
    <div id="infoModal" class="modal" style="display: none">
      <div class="modal-content">
        <span class="close" id="closeInfoModal">&times;</span>
        <h2 class="modal-title">Como usar o DBcolor</h2>
        <p class="modal-description">
          O sistema analisa resultados em tempo real e emite alertas de cor
          quando padrões são detectados.
        </p>
        <ul style="color: #c0c8e0; margin: 0 0 14px 18px">
          <li>Espere um alerta e aposte na cor indicada.</li>
          <li>Use a proteção ao Branco quando indicado.</li>
          <li>Até 3 tentativas por sinal, com status "Tentativa X/3".</li>
        </ul>
        <p class="modal-description">
          Acompanhe os resultados recentes e o card de sinal para saber quando
          apostar.
        </p>
        <label
          style="
            display: flex;
            align-items: center;
            gap: 8px;
            color: #a0a8c8;
            margin: 10px 0 18px 0;
          ">
          <input type="checkbox" id="dontShowInfoAgain" />
          Não mostrar novamente
        </label>
        <button id="infoOkBtn" class="btn-primary">Entendi</button>
      </div>
    </div>
  </body>
</html>
